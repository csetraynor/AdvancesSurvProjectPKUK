Data summary
============

#### _Carlos S Traynor_

#### _05/10/2018_

Data charecterisation
---------------------

Here we summarise the general features of the lung squamos cell (LUSC) and colon adenocarcinoma (COAD) TCGA datasets. The data have been downloaded from TCGA and the CBioPortal following these links: LUSC: [http://www.cbioportal.org/study?id=lusc\_tcga#clinical](http://www.cbioportal.org/study?id=lusc_tcga#clinical) COAD: [http://www.cbioportal.org/study?id=coadread\_tcga#summary](http://www.cbioportal.org/study?id=coadread_tcga#summary)

We will use the following libraries:

    if(!require("devtools")) install.packages("devtools")
    if(!require("tidyprojectAZ")) devtools::install_github("tsahota/tidyprojectAZ")
    library(tidyprojectAZ)

Colorectal adenocarcinoma
-------------------------

First we will load the data and make a basic preprocess, to include later the genomic covariates in the model we will filter the clinical dataset for those individuals that also have genomic measurements:

    coad_clinical <- "~/test-data/coadread_tcga/data_bcr_clinical_data_patient.txt"
    convert_blank_to_na <- function(x) {
        if (!purrr::is_character(x)) {
            return(x)
            print("Error not character")
        } else {
            ifelse(x == "" | x == "[Not Available]" | x == "--" | x == 
                "not reported" | x == "[Not Applicable]" | x == "[Discrepancy]", 
                NA, x)
        }
    }
    preprocess_clinical <- function(file) {
        clinical_data <- readr::read_tsv(file, skip = 4)
        # convert variable names to lower case
        colnames(clinical_data) <- tolower(colnames(clinical_data))
        # convert all string NA to NA format
        clinical_data <- clinical_data %>% dplyr::mutate_all(dplyr::funs(convert_blank_to_na))
        clinical_data
    }
    
    coad_clinical <- preprocess_clinical(coad_clinical)
    ## Load patient id all
    match_remove_is_na <- function(x, y) {
        match(x, y)[!is.na(match(x, y))]
    }
    patient_id <- readRDS("~/iClusterPlusUtils/coad/coad_complete_patient_id.RDS")
    coad_clinical <- coad_clinical[match_remove_is_na(patient_id, coad_clinical$patient_id), 
        ]
    dplyr::glimpse(coad_clinical)

    ## Observations: 301
    ## Variables: 64
    ## $ other_patient_id                        <chr> "A94E1279-A975-480A-93...
    ## $ patient_id                              <chr> "TCGA-3L-AA1B", "TCGA-...
    ## $ form_completion_date                    <chr> "4/22/14", "10/1/14", ...
    ## $ histological_diagnosis                  <chr> "Colon Adenocarcinoma"...
    ## $ prospective_collection                  <chr> "YES", "YES", "NO", "N...
    ## $ retrospective_collection                <chr> "NO", "NO", "YES", "YE...
    ## $ sex                                     <chr> "Female", "Male", "Fem...
    ## $ days_to_birth                           <chr> "-22379", "-24523", "-...
    ## $ race                                    <chr> "BLACK OR AFRICAN AMER...
    ## $ ethnicity                               <chr> "NOT HISPANIC OR LATIN...
    ## $ history_other_malignancy                <chr> NA, "No", "No", "No", ...
    ## $ history_neoadjuvant_trtyn               <chr> "No", "No", "No", "No"...
    ## $ initial_pathologic_dx_year              <int> 2013, 2013, 2013, 2009...
    ## $ ajcc_staging_edition                    <chr> "7th", "7th", "7th", "...
    ## $ ajcc_tumor_pathologic_pt                <chr> "T2", "T4a", "T3", "T4...
    ## $ ajcc_nodes_pathologic_pn                <chr> "N0", "N1b", "N0", "N2...
    ## $ ajcc_metastasis_pathologic_pm           <chr> "M0", "M0", "MX", "M1a...
    ## $ ajcc_pathologic_tumor_stage             <chr> "Stage I", "Stage IIIB...
    ## $ residual_tumor                          <chr> "R0", "R0", "R0", "R2"...
    ## $ lymph_nodes_examined                    <chr> "YES", "YES", "YES", "...
    ## $ lymph_node_examined_count               <chr> "28", "25", "24", "11"...
    ## $ lymph_nodes_examined_he_count           <chr> "0", NA, "0", "10", "0...
    ## $ lymph_nodes_examined_ihc_count          <chr> "0", "2", NA, "0", NA,...
    ## $ vital_status                            <chr> "Alive", "Alive", "Ali...
    ## $ days_to_last_followup                   <chr> "154", "8", "160", NA,...
    ## $ days_to_death                           <chr> NA, NA, NA, "290", NA,...
    ## $ tumor_status                            <chr> "TUMOR FREE", "WITH TU...
    ## $ vascular_invasion_indicator             <chr> "NO", "NO", "NO", "YES...
    ## $ lymphovascular_invasion_indicator       <chr> "NO", "NO", "NO", "YES...
    ## $ perineural_invasion                     <chr> "NO", "NO", "NO", "YES...
    ## $ kras_gene_analysis_indicator            <chr> "NO", "NO", "NO", "NO"...
    ## $ kras_mutation                           <chr> NA, NA, NA, NA, NA, NA...
    ## $ braf_gene_analysis_indicator            <chr> "NO", "NO", "NO", NA, ...
    ## $ braf_gene_analysis_result               <chr> NA, NA, NA, NA, NA, NA...
    ## $ weight                                  <chr> "63.3", "134", "107.95...
    ## $ height                                  <chr> "173", "167.64", "167....
    ## $ radiation_treatment_adjuvant            <chr> NA, "NO", "NO", "NO", ...
    ## $ pharmaceutical_tx_adjuvant              <chr> NA, "YES", "NO", "YES"...
    ## $ treatment_outcome_first_course          <chr> "Complete Remission/Re...
    ## $ new_tumor_event_after_initial_treatment <chr> "NO", "NO", "NO", "YES...
    ## $ age                                     <int> 61, 67, 42, 40, 75, 48...
    ## $ primary_site                            <chr> "Cecum", "Ascending Co...
    ## $ clin_m_stage                            <lgl> NA, NA, NA, NA, NA, NA...
    ## $ clin_n_stage                            <lgl> NA, NA, NA, NA, NA, NA...
    ## $ clin_t_stage                            <lgl> NA, NA, NA, NA, NA, NA...
    ## $ clinical_stage                          <lgl> NA, NA, NA, NA, NA, NA...
    ## $ days_to_initial_pathologic_diagnosis    <int> 0, 0, 0, 0, 0, 0, 0, 0...
    ## $ days_to_patient_progression_free        <lgl> NA, NA, NA, NA, NA, NA...
    ## $ days_to_tumor_progression               <lgl> NA, NA, NA, NA, NA, NA...
    ## $ disease_code                            <chr> NA, NA, NA, NA, "FPPP"...
    ## $ extranodal_involvement                  <lgl> NA, NA, NA, NA, NA, NA...
    ## $ icd_10                                  <chr> "C18.0", "C18.2", "C18...
    ## $ icd_o_3_histology                       <chr> "8140/3", "8140/3", "8...
    ## $ icd_o_3_site                            <chr> "C18.0", "C18.2", "C18...
    ## $ informed_consent_verified               <chr> "YES", "YES", "YES", "...
    ## $ initial_pathologic_diagnosis_method     <lgl> NA, NA, NA, NA, NA, NA...
    ## $ project_code                            <chr> NA, NA, NA, NA, "TCGA"...
    ## $ stage_other                             <lgl> NA, NA, NA, NA, NA, NA...
    ## $ tissue_source_site                      <chr> "3L", "4N", "4T", "5M"...
    ## $ tumor_tissue_site                       <chr> "Colon", "Colon", "Col...
    ## $ os_status                               <chr> NA, "LIVING", "LIVING"...
    ## $ os_months                               <chr> NA, "4.8", "12.65", "9...
    ## $ dfs_status                              <chr> NA, "DiseaseFree", "Di...
    ## $ dfs_months                              <chr> NA, "4.8", "12.65", "7...

In the tidy description of the dataset obtained with glimpse we see that we have covariates that may potentially be used as treatment effect : 
- pharmaceutical\_tx\_adjuvant 
- radiation\_treatment\_adjuvan 
- history\_neoadjuvant\_trtyn

Then we have variables that may be considered secondary outcome and potentially joint modelled with the overall survival: - treatment\_outcome\_first\_course - new\_tumor\_event\_after\_initial\_treatment - dfs\_status - dfs\_months

We can visualise the missing values of these variables with the VIM package:

    coad_clinical %>% dplyr::select(tx = pharmaceutical_tx_adjuvant, 
        rad_tx = radiation_treatment_adjuvant, tx_out = treatment_outcome_first_course, 
        recurred = new_tumor_event_after_initial_treatment, h_neo = history_neoadjuvant_trtyn, 
        dfs_status, dfs_t = dfs_months) %>% VIM::aggr(prop = T, labels = colnames(.), 
        numbers = TRUE)

